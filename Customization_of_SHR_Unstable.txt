# On the workstation:
sudo iptables -A POSTROUTING -t nat -j MASQUERADE -s 192.168.5.0/24
sudo sysctl -w net.ipv4.ip_forward=1

# On the GTA02...
# Flash a recent kernel and rootfs from "SHR-unstable" distro, using "dfu-util".
#  Boot it up and log in via SSH.

# remove all unnecessary software (must do!):
opkg remove --force-removal-of-dependent-packages xserver*
opkg remove --force-removal-of-dependent-packages xorg*
opkg remove --force-removal-of-dependent-packages xf86*
opkg remove --force-removal-of-dependent-packages shr*
opkg remove --force-removal-of-dependent-packages fso*
opkg remove --force-removal-of-dependent-packages phone*

## Theses kernel modules are not necessary and should never be loaded (rename or delete them):
rm /lib/modules/*/kernel/net/bluetooth/hidp/hidp.ko
rm /lib/modules/*/kernel/net/bluetooth/l2cap.ko
rm /lib/modules/*/kernel/net/bluetooth/rfcomm/rfcomm.ko
rm /lib/modules/*/kernel/net/bluetooth/bluetooth.ko
rm /lib/modules/*/kernel/sound/soc/snd-soc-core.ko
rm /lib/modules/*/kernel/sound/soc/codecs/snd-soc-wm8753.ko
rm /lib/modules/*/kernel/sound/soc/s3c24xx/snd-soc-s3c24xx.ko
rm /lib/modules/*/kernel/sound/soc/s3c24xx/snd-soc-s3c24xx-i2s.ko
rm /lib/modules/*/kernel/sound/soc/s3c24xx/snd-soc-neo1973-wm8753.ko
rm /lib/modules/*/kernel/sound/core/snd-page-alloc.ko
rm /lib/modules/*/kernel/sound/core/snd-pcm.ko
rm /lib/modules/*/kernel/sound/core/snd.ko
rm /lib/modules/*/kernel/sound/core/snd-timer.ko
rm /lib/modules/*/kernel/sound/soundcore.ko
rm /lib/modules/*/kernel/drivers/bluetooth/btusb.ko

# configure networking:
sed -i 's/192.168.0/192.168.5/' /etc/network/interfaces
passwd
reboot

# install necessary software (check if networking is working first with "ping google.com"):
opkg update
opkg install kernel-module-joydev
opkg install openssh-sftp-server
opkg install htop
opkg install python-pygame
opkg install python-netserver python-netclient

# Copy all the project files from "DiffTrike/SoapBoxMkII/" into "/home/root/" of the GTA02
# you can use "scp" or any SFTP enabled file manager application.

# set executable permissions and install application as daemon:
chmod +x sb2.py
chmod +x soapbox.sh
rm /etc/network/interfaces
ln -s /home/root/interfaces /etc/network/interfaces
ln -s /home/root/soapbox.sh /etc/init.d/soapbox.sh
update-rc.d -v soapbox.sh defaults

